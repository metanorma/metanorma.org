---
layout: author-docs
---

= References and bibliography

== General

In standard documents typically there are two types of references, namely
the "`Normative references`" and the "`Bibliography`" (informative references).

The following fixed clause names identifies a bibliography:

* `Normative references`
* `Bibliography`


Every bibliographic section must be preceded by the style attribute
`[bibliography]` so that references they contain may be recognized as such:

[source,asciidoc]
----
[bibliography]
== Bibliography

* [[[id1,1]]] _First reference_
* [[[id2,2]]] _Second reference_
* [[[id3,3]]] _Third reference_
----

[example]
.Example of creating the "`Normative references`" clause in an ISO deliverable
====
In ISO, the "`Normative references`" clause is stated in
Clause 2 (ISO Directives Part 2, Clause 15), while the "`Bibliography`"
section is set as the last unnumbered section at the end of document
(ISO Directives Part 2, Clause 21). It should be typeset as the following:

[source,asciidoc]
----
...
// This is Clause 2 of an ISO deliverable
[bibliography]
== Normative references

* [[[ISO8601-1,ISO 8601-1:2019]]] _First normative reference_
* [[[ISO8601-2,ISO 8601-2:2019]]] _Second normative reference_

...

// This is after the last clause of an ISO deliverable
[bibliography]
== Bibliography

* [[[ISO10241-1,ISO 10241-1]]] _First bibliographic reference_
...
----
====

Normative and informative references are normally recognised by the
distinct title given them, specific to the flavour; however, the normative
status of the bibliographic section can be given explicitly with
a `normative` boolean
attribute [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v1.8.7]:

[source,asciidoc]
----
[bibliography,normative=true]
== References normative

...

[bibliography,normative=false]
== References informative
----

Bibliography sections can be split into subsections.
Metanorma AsciiDoc requires each subsection containing references
to be styled with `[bibliography]`, and raises an (ignorable)
warning if the subsections are contained in a section itself
styled with `[bibliography]`.

[example]
.Example of having multiple bibliography sub-sections
====
[source,asciidoc]
--
== Bibliography

[bibliography]
=== Part 1

* [[[id1,1]]] _First reference_
* [[[id2,2]]] _Second reference_
* [[[id3,3]]] _Third reference_

[bibliography]
=== Part 2

* [[[id4,4]]] _Fourth reference_
* [[[id5,5]]] _Fifth reference_
* [[[id6,6]]] _Sixth reference_
--
====

NOTE: A warning will be raised if `== Bibliography` in the above EXAMPLE was
preceded by `[bibliography]`.

[NOTE]
====
In Metanorma IETF, the bibliography sections "`Normative references`"
and "`Informative references`" are separate, where the
"`Informative references`" section is optional:

[source,asciidoc]
--
[bibliography]
== Normative references

* [[[id1,1]]], _First normative reference_
...

// Optional
[bibliography]
== Informative references

* [[[idn, n]]], _First informative reference_
...

--

See link:/author/ietf/topics/references/[References (AsciiRFC v3)]
for further details.
====

== Numbering and ordering

All entries in a bibliography section, whether standards or generic,
are renumbered incrementally in the Metanorma XML. If the number for
generic references is updated, all citations of that reference will
be updated as well.

By default, Metanorma does not change the ordering of references in the
bibliography sections from what has been entered by the authors.
Some Metanorma flavours *will* reorder references to suit document
requirements.

That said, all references in a references section are grouped together,
even if there is intervening text in the source document. Only notes
are left attached to their reference, in order to enable annotated
bibliographies.


== Predefined text

=== General

In the "Normative references" clause, any content before the list of references
is ignored, and replaced by predefined text specific to the Metanorma flavour.

The predefined text may vary according to the contents of the bibliography:

* an empty bibliography will usually have different initial text from a
bibliography with references;

* for some flavours, text will be different depending on whether the references are dated or not.


=== When located in a subclause

If the list of normative references are nested in a subclause, the predefined
text is placed in the first clause that contains references, and no other clause
types.

This is to allow the predefined text to be associated with nested
bibliographies, but not clauses containing both references and other
text [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.8.12].

[source,asciidoc]
----
[bibliography]
== Normative references

// boilerplate goes here

[bibliography]
=== Simple references

[bibliography]
=== Complex references
----

[source,asciidoc]
----
== General

=== Scope

[bibliography]
=== Normative references

// boilerplate goes here
----



=== Overriding predefined text

To override default predefined text, the user can provide their own initial text
with an open block marked as `boilerplate` containing the
text [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.3.0].

NOTE: Prior to v2.3.0, the method of overriding default predefined text is by
using a NOTE of type "`boilerplate`"
[added in https://github.com/metanorma/metanorma-standoc/releases/tag/v1.9.2].

.Example of overriding predefined text of a Normative references clause
====
[source,asciidoc]
----
[bibliography]
== Normative references

[.boilerplate]
--
The following contract document is referred to in the text in such a
way that some or all of its content constitutes requirements of this
document.
--
----
====

=== Moving predefined text

To move the default predefined text elsewhere in the bibliography
structure, set the content of the boilerplate block as
`(default)` [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.8.12].

The `(default)` text will be overwritten with the correct predefined text.

.Example of moving default predefined text
====
[source,asciidoc]
----
[bibliography]
== Normative references

[bibliography]
=== Normative references

[.boilerplate]
--
(default)
--
----
====




== Entering individual references

Bibliographic entries are entered as unordered lists in Metanorma AsciiDoc
within a dedicated clause or section.

A single bibliographic entry must be preceded by a bibliographic anchor, in
_triple brackets_, as shown in the following syntax:

[source,asciidoc]
--
* [[[{anchor},{document identifier or reference tag}]]], _{reference list text}_
--

The following data elements are needed in a reference entry:

* anchor
* document identifier or reference tag
* reference list text

anchor:: a user-defined string that is an internal identifier used  for
cross-referencing within the current document. This string is typically composed
with ASCII characters and hyphens or underscores. Other characters are not
recommended. +
+
WARNING: See link:/author/topics/document-format/xrefs#text-ref-allowed-anchors[Anchor ID syntax]
for allowed characters in anchor IDs.

document identifier:: the authoritative document identifier of the bibliographic item.
Standardized deliverables such as International Standards from ISO and IEC are
assigned authoritative identifiers, such as "ISO 8601-1" or "ISO 8601-1:2019".
This is often used for auto-fetching of bibliographic details (see <<autofetch,auto-fetch>>).
When a document identifier is used, the reference tag is also set to be identical.

reference tag:: a user-defined string used for rendering a mention of this
bibliographic item in the resulting output. This is typically in a format
defined by the user, or publication conventions adopted by the user.
See <<reference-tags>> for more information.

reference list text:: a user-defined, pre-formatted description about the
bibliographic item. This text is either formatted according to ISO 690:2021, or
publication conventions like MLA, APA or the Chicago Manual of Style.
If encoded in the ISO 690:2021 format, the resulting citation will be a
machine-readable one. If the bibliographic entry is auto-fetched, the
reference list text can be left out, as it will instead be generated based on the
fetched entry.

A bibliographic reference can optionally be followed by one or more notes. This allows an
annotated bibliography to be generated. Notes are sorted together with their preceding bibliographic entry.

[source,asciidoc]
----
* [[[ref1,ISO 639:1988]]], _Code for individual languages and language groups_

NOTE: This standard was subsequently split up from 1998 into parts.

NOTE: This was the first edition to use two-letter codes.

* [[[ref2,ISO 639-2:1998]]], _Code for individual languages and language groups, Part 2: Alpha-3 code_

NOTE: This is the first instance of three-letter codes in ISO-639.
----

== Best practice

There are myriad ways of entering bibliographic references as shown in
<<entering-refs>>.

As best practice, we recommend the following order of entering bibliographic
references, only using a later method if the former method does not:

. <<autofetch>>
.. <<auto-pubid-lookup>>
.. <<auto-crossref-lookup>>
.. <<auto-isbn-lookup>>
. Manual encoding
.. <<annotated-spans>>
.. <<asciibib>>
.. <<preformatted-citation>>


It is strongly recommended that the <<autofetch,automatic fetching>> method be
used for data consistency, correctness, and the ease of use whenever possible.

If automatic fetching is not available for a particular reference, and if
machine-readability or accurate rendering is important, either
use <<annotated-spans,annotated citation spans>> or <<asciibib,AsciiBib>> for
entering structured and detailed bibliographic information within a document.

The basic form of a reference is a
<<preformatted-citation,pre-formatted reference>>, which relies on the user to
supply a properly formatted reference.


[[reference-tags]]
== Reference tags

=== Implied reference tags

Bibliographic entries for standards are expected to have the standard
document identifier as the item label. References to well-defined
standards codes use the document identifiers for citations
(e.g. `ISO 20483:2013`).

This is entered as:

[source,asciidoc]
--
* [[[{anchor},{document identifier as reference tag}]]], _{reference list text}_
--

[example]
.Example of implied reference tags
====
[source,asciidoc]
--
* [[[ISO20483,ISO 20483:2013]]], _Cereals and cereal products -- Determination of moisture content -- Reference method_
* [[[ISO6540,ISO 6540:1980]]]. _Maize -- Determination of moisture content (on milled grains and on whole grains)_
--

gets rendered as:

____
* ISO 20483:2013. _Cereals and cereal products -- Determination of moisture content -- Reference method_
* ISO 6540:1980. _Maize -- Determination of moisture content (on milled grains and on whole grains)_
____
====

A well-defined standards code as the item label will by default result in the
reference details for the bibliographic entry being auto-fetched, provided that
auto-fetching has been defined for that class of standard (<<autofetch>>).

=== Overriding fetching

If an individual reference identifier is wrapped in `nofetch()`, the reference details for that
item are not looked up, though other items still will be:

[source,asciidoc]
--
[bibliography]
== Bibliography

* [[[ref1,nofetch(ISO 639-1)]]], ISO 639-1.
* [[[ref2,ISO 639-2]]], ISO 639-2.
--


=== Numeric reference tags

Generic references in bibliographies, as opposed to standards
references, use numbers, which are rendered bracketed, like `[1]`.

This is entered as:

[source,asciidoc]
--
* [[[{anchor},{number}]]], _{reference list text}_
--

[example]
.Example of specifying numeric reference tags
====
[source,asciidoc]
--
* [[[ISO20483,1]]], _ISO 20483:2013 Cereals and cereal products -- Determination of moisture content -- Reference method_
* [[[ISO6540,1]]]. _ISO 6540:1980 Maize -- Determination of moisture content (on milled grains and on whole grains)_
--

gets rendered as:

____
* [1] _ISO 20483:2013 Cereals and cereal products -- Determination of moisture content -- Reference method_
* [2] _ISO 6540:1980 Maize -- Determination of moisture content (on milled grains and on whole grains)_
____
====

NOTE: To indicate usage of the numeric reference system, any number
can be entered into the reference tag field. All references are
automatically re-sorted and auto-incremented during compilation.

Normative references must use either standard document identifiers, or named reference tags.

NOTE: Numeric references cannot be used for entries in normative references, as bibliography numbering starts at 1.
Execution will abort if a numeric reference tag is found in normative references, in order to prevent
numbering confusion [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v1.8.4].

=== Blank reference tags

If no document identifier is to be provided for the reference, give the reference tag as a space:

[example]
.Example of specifying numeric reference tags
====
[source,asciidoc]
--
* [[[ISO20483, ]]], _ISO 20483:2013 Cereals and cereal products -- Determination of moisture content -- Reference method_
--

This has the same effect as specifying the reference tag with `dropid(...)` 
(see <<dropid>>) [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v3.1.7].


=== Named reference tags

==== General

References can be tagged with user-supplied alphanumeric labels,
in addition to numbers or standard document identifiers.

These are indicated by wrapping the label within the bibliographic
anchor in brackets.

==== Named reference tag with fully specified bibliographic entry

If the reference text is fully specified, and where no auto-fetching of
the bibliographic entry is necessary, a user-supplied label is entered
using the following syntax:

[source,asciidoc]
--
* [[[{anchor},({reference tag})]]], _{reference list text}_
--

NOTE: These alphanumeric labels will not result in the bibliographic
entry being auto-fetched.

[example]
.Sample named reference tag with fully specified bibliographic entry
====
[source,asciidoc]
--
* [[[ISO20483,(CerMoist)]]], _ISO 20483:2013 Cereals and cereal products -- Determination of moisture content -- Reference method_
* [[[ISO6540,(MaiMoist)]]]. _ISO 6540:1980 Maize -- Determination of moisture content (on milled grains and on whole grains)_
--

gets rendered as:

____
* [CerMoist] _ISO 20483:2013 Cereals and cereal products -- Determination of moisture content -- Reference method_
* [MaiMoist] _ISO 6540:1980 Maize -- Determination of moisture content (on milled grains and on whole grains)_
____
====


==== Named reference tag with automatic reference fetching

Users can provide both their own alphanumeric label, and the well-defined
publication identifier for a cited standards document.

If the publication identifier is recognized for auto-fetching, the bibliographic
entry will be automatically retrieved.
 [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v1.3.15]:

If the publication identifier is not recognized for auto-fetching, the
bibliographic entry will display the user-supplied reference list text after the
comma.

If a named reference is to be auto-fetched, it is entered by prefixing
the named reference tag (in parentheses) to the publication identifier:

[source,asciidoc]
--
* [[[{anchor},({reference tag}){publication identifier}]]], _{reference list text}_
--

[[ex-named-ref]]
[example]
.Example of named reference tag fetched automatically
====
[source,adoc]
----
* [[[ISO20483,(CerMoist)ISO 20483]]] _ISO 20483:2013 Cereals and cereal products -- Determination of moisture content -- Reference method_
* [[[ISO6540,(MaiMoist)ISO 6540]]] _ISO 6540:1980 Maize -- Determination of moisture content (on milled grains and on whole grains)_
----
====

Rich-text formatting is supported within the named reference tag
 [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.0.3].

[example]
.Example of rich-text formatting in named reference tag
====
[source,adoc]
----
* [[[ISO9000,(ISO/IEC Guide **99**:2007)ISO/IEC Guide 99:2007]]]
* [[[ISO9000,(ISO 9000:2005 footnote:[Superseded by ISO 9000:2015.])ISO 9000:2005]]]
----
====

WARNING: It is strongly advised not to use rich-text formatting within named
reference tags, as it can lead to unexpected results and problems with
copy-pasting.

The preferred way of modifying a fetched reference to add a footnote indicating its status
(added to the reference tag in most flavours) is to give a footnote after the citation.
This is useful for cases where a cited reference is out-of-date but unsuitable
to be updated [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v3.1.6].

[example]
.Example of added footnote to a named reference tag (ISO/IEC 17025:2017)
====
[source,adoc]
----
* [[[ISO_IEC_Guide_99_2007,ISO/IEC Guide 99:2007]]] footnote:[Also known as JCGM 200]

* [[[ISO_IEC_17000_2004,ISO/IEC 17000:2004]]]
----

.Footnote in ISO/IEC 17025:2017 on ISO/IEC Guide 99:2007
image::/assets/author/topics/document-format/bibliography/ref-with-footnote.png[Footnote in ISO/IEC 17025:2017 on ISO/IEC Guide 99:2007]
====

==== Numeric reference tag with automatic reference fetching

An automatically-fetched reference can be assigned a numeric reference tag, by
using the same previous method with the sole difference of putting a number
instead of a name.

This approach is useful when working with flavors whose reference system is
named by default, such as ITU.

[example]
.Example of numeric reference tag with automatic fetching
====
[source,adoc]
----
* [[[h760,(1)ITU-T H.760]]] Recommendation ITU-T H.760 (2009), _Overview of multimedia application frameworks for IPTV services_.

* [[[x1255,(1)ITU-T X.1255]]] Recommendation ITU-T X.1255 (2013), _Framework for discovery of identity management information_.
----
====

NOTE: Any number can be entered between the parentheses.
The references will be incrementally re-sorted according to standard drafting
rules specified by the flavor during compilation.

NOTE: In the case of encoding bibliography items in ISO deliverables, this
practice is not necessary -- the reference system used in the bibliography of
ISO deliverables is already numeric by default. Numeric tags do not need to be
explicitly specified.

[[entering-refs]]
== Entering bibliographic references

[[autofetch]]
=== Automatic fetching via Relaton ("auto-fetch")

==== General

https://www.relaton.org/[Relaton] can fetch bibliographic entries
for any standards known to have online bibliographic databases.

Any bibliographic entry recognized through its document identifier prefix
will by default have its bibliographic entry fetched by the appropriate
Relaton extension.

The fetched data overrides any content about the item provided in the document,
since the online bibliography is treated as the source of truth for that
standards document.

[[auto-pubid-lookup]]
==== Standards identifier / Document identifier lookup

The format of the standard identifier required for automatic lookup is documented at
link:/author/basics/reference-lookups/[Automatic reference lookup].

NOTE: Currently Metanorma supports auto-fetching document identifiers supported
by Relaton, see https://www.relaton.org/guides/[here] for the full list.

[example]
.Example of specifying an auto-fetched reference
====
The following will trigger auto-fetching:

[source,asciidoc]
--
* [[[ref1,ISO 20483]]]
--

and gets rendered as:

____
ISO 20483:2013. _Cereals and cereal products -- Determination of moisture content -- Reference method_
____
====

[[auto-crossref-lookup]]
==== DOI identifier lookup

DOI identifiers are supported as auto-fetch targets [added in
https://github.com/relaton/relaton-cli/releases/tag/v1.14.0] through the
Crossref bibliographic information service.

This means that any book, journal article, conference paper or dataset that has
a DOI and bibliographic information at Crossref can be cited by providing its
DOI identifier as its bibliographic tag. Metanorma will import the bibliographic
details of the reference from Relaton and format them in the required format of
the current Metanorma flavour.

This is triggered by an identifier string prefixed with `doi:` or `DOI `,
followed by the full DOI identifier.

[example]
.Example of specifying an auto-fetched DOI reference
====
The following will trigger auto-fetching:

[source,asciidoc]
--
* [[[ref1,doi:10.1045/november2010-massart]]]
--

and gets rendered as:

____
Massart D., Shulman E., Nicholas N., Ward N., &#x26; Bergeron F. Taming the Metadata Beast: ILOX. _D-Lib Magazine_ Vol. 16 No. 11/12. November 2010. Available from: link:http://dx.doi.org/10.1045/november2010-massart"
____
====

[[auto-isbn-lookup]]
==== ISBN identifier lookup

ISBN identifiers are supported as auto-fetch targets [added in
https://github.com/relaton/relaton-cli/releases/tag/v1.14.0] through the
OpenLibrary API
service [added in https://github.com/relaton/relaton-cli/releases/tag/v1.17.2].

This is triggered by an identifier string prefixed with `isbn:` or `ISBN `,
with the number following the ISBN-10 or ISBN-13 number, with or without dashes.

[example]
.Example of specifying an auto-fetched ISBN reference
====
The following will trigger auto-fetching:

[source,asciidoc]
--
* [[[ref1,ISBN 978-0-12-064481-0]]]
--

and gets rendered as:

____
Arvo, J. _Graphics gems II_. 1991. Boston, London: AP Professional.
____
====


=== Automatic fetching of joint publications

Metanorma recognises two types of joint publication:

* Joint publications proper (or merged publications), in which the one document
is considered to be published simultaneously by two different standards bodies.
+
In the case of ISO and IEC, there are longstanding partnerships with each other
and with IEC, and this is reflected in the identifier assigned by the standards
organisation (e.g. ISO/IEC DIR 1).
+
In other cases, the document is assigned a different identifier by each of the
standards organisations involved, but it is still considered to be the same
publication, and is described in a single bibliographic entry.

* Dual publications, for which the publications are treated as separate
bibliographic entries, listed together with phrasing like "also published as:".
+
In dual publications, the publications are regarded as separate activities with
separate metadata, rather than a joint coordinated responsibility.
+
In case the partnership is not acknowledged in the document identifier (the documents are assigned
two separate identifiers), the two separate bibliographic entries can still be fetched by Relaton,
and brought together in the Metanorma
bibliography [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.6.1].

* `[[[anchor,merge(CODE1, CODE2)]]]` merges together the two bibliographic
entries fetched under `CODE1` and `CODE2`: the bibliographic entry is that of
`CODE1`, but the publication information of `CODE2` (the publishing organisation
and the distinct document identifier) are added to the entry.
+
.Rendering of a jointly published bibliographic item
====
ISO 10712 | ITU-R 232. _ISO title of document_.
International Organization for Standardization and International Telecommunications Union.
====

* `[[[anchor,dual(CODE1, CODE2)]]]` treats the two bibliographic entries separately.
+
.Rendering of a dual-published bibliographic item
====
ISO 10712.
_ISO title of document_. International Organization for Standardization.
Also published as: ITU-R 232. _ITU title of document_. International Telecommunications Union.
====

[[other-databases]]
=== Referencing from a Metanorma collection

Metanorma allows bibliographic entries to be specified for retrieval from a
Metanorma
collection [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v1.4.1].

Details on link:/author/topics/collections/cross-referencing[Collections cross-referencing].
This is achieved with the following syntax:

[source,asciidoc]
--
* [[[anchor,repo:(repository-name/document-entry,document-identifier)]]]
--

This retrieves item `document-entry` from repository `repository-name`; the document
identifier "document-identifier" is retained in order for citations to remain well-formed.

By default, `repo:(repository-name/document-entry)` is left in the Metanorma XML as
a document identifier, of type `repo`; it will typically be resolved in post-processing.

NOTE: The `repo:(...)` function is mutually exclusive to `path:(...)`, they
cannot be used together.

NOTE: Bibliographical information about the entry is *not* auto-fetched via Relaton.


=== Referencing an attachment

Metanorma allows entries to specify file attachments, as described in
link:/author/topics/sections/attachments[Attachments] [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.8.10].

This is achieved with the following syntax:

[source,asciidoc]
--
* [[[anchor,attachment:(file location of attachment relative to current file)]]]
--


[[hyperlink-biblio]]
=== Referencing from Metanorma or Relaton files

Metanorma allows bibliographic entries to be specified by either relative or absolute
paths [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v1.4.1],
where a path leads to a Metanorma XML or a Relaton RXL reference file.

This is achieved with the following syntax:

[source,asciidoc]
--
* [[[anchor,path:(hyperlink,document-identifier)]]]
--

As with `repo:()` bibliographic entries, the document identifier
`document-identifier` is retained in order for citations to remain well-formed.

If the hyperlink is local, Metanorma will look for an XML (Metanorma XML) or RXL
(Relaton XML) file at the nominated location with the same filename, and read in
the bibliographic metadata from there.

All citations of this entry in the document (referencing `anchor`) will be
rendered with the hyperlink in HTML.

NOTE: The `path:(...)` function is mutually exclusive to `repo:(...)`, they
cannot be used together.

NOTE: Bibliographical information about the entry is *not* auto-fetched via Relaton.


[[preformatted-citation]]
=== Entering pre-formatted references

For generic references, by default, Metanorma only supports formatted
references, which are given as such in the AsciiDoc source.

[example]
.Example of a pre-formatted reference
====
[source,asciidoc]
----
[bibliography]
== Normative references

* [[[edge_mesh,Edge Mesh]]], Y. SAHNI, J. CAO, S. ZHANG and L. YANG.
_Edge Mesh: A New Paradigm to Enable Distributed Intelligence in Internet of Things_.
In: IEEE Access, vol. 5, pp. 16441-16458, 2017, doi: 10.1109/ACCESS.2017.2739804.
----

This is rendered as:

____
[1] Y. SAHNI, J. CAO, S. ZHANG and L. YANG.
_Edge Mesh: A New Paradigm to Enable Distributed Intelligence in Internet of Things._
In: IEEE Access, vol. 5, pp. 16441-16458, 2017, doi: 10.1109/ACCESS.2017.2739804.
____
====

NOTE: The NIST flavour of Metanorma currently supports rendering of generic
references, on an experimental basis. See the
link:/author/basics/reference-lookups[Automatic reference lookup]
topic for more details.

[[annotated-spans]]
=== Annotating pre-formatted references using semantic elements

While a pre-formatted reference is not explicitly broken down into its semantic
components, it may be expedient to mark up segments of the reference
semantically, to provide information which is useful for parsing.

[example]
In order to generate an author-date reference, it is necessary to indicate the
author surnames and publication date.

For that reason, a limited number of span categories can be used to annotate a
pre-formatted
reference [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.1.6].

These are not an exhaustive list of bibliographic fields, and if more detail is
required (or a dynamically generated reference is to be generated), one of the
following explicit bibliographic entry methods should be used instead.

The span categories supported are:

`surname`::
Author surname.

`initials`::
Author initials.

`givenname`::
Author given name.

`fullname`::
Combination of author surname and initials or given names, according to strict syntax
(see below) [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.3.0]

`organization`::
Corporate author.

`surname.XXX`::
Contributor surname, with role _XXX_ (e.g. _editor_).

`initials.XXX`::
Contributor initials, with role _XXX_ (e.g. _editor_).

`givenname.XXX`::
Contributor given name, with role _XXX_ (e.g. _editor_).

`fullname.XXX`::
Contributor full name, with role _XXX_ (e.g. _editor_).

`organization.XXX`::
Corporate contributor, with role _XXX_ (e.g. _editor_).

`title`::
Title.

`in_title`::
Title of containing bibliographic item. For types `inbook`, `inproceedings`, `incollection`,
the title of the book, proceedings, collection containing the item.

`in_surname`, `in_initials`, `in_givenname`, `in_organization`::
Name of contributor for containing bibliographic item
+
For types `inbook`, `inproceedings`, `incollection`, the author or more usually
editor of the book, proceedings, collection containing the item.
+
So `in_surname.editor`, `in_givenname.editor` give the name of the editor of the
book or proceedings that a paper is included in.

`series`::
Series title. For articles, this is the journal title.

`docid`::
Document identifier.

`docid.XXX`::
Document identifier, of type _XXX_.

`publisher`::
Publisher.

`pubplace`::
Place of publication.

`date`::
Date published. All dates in Metanorma are entered in ISO 8601-1:2019 `YYYY-MM-DD` format.

`date.XXX`::
Date with type _XXX_ (e.g. _published_, _created_, _issued_)

`edition`::
Edition

`version`::
Version

`note`::
Note (can also be used for miscellaneous content)

`uri`::
URI.

`uri.XXX`::
URI, of type _XXX_.

`classification`::
Classification of bibliographic resource [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.9.8]

`classification.XXX`::
Classification of bibliographic resource as being of type _XXX_
 [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.9.8]
+
[example]
`span:classification.color[red]` can be interpreted as "the bibliographic
resource is classified as having color: red".

`abstract`::
Abstract of bibliographic resource, can contain inline markup [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.9.8]

`pages`::
page or page range (e.g. _9_, _9-11_)

`issue`::
issue or issue range (e.g. _9_, _9-11_)

`volume`::
volume or volume range (e.g. _9_, _9-11_)

`type`::
Document type. List of valid document types given in
https://www.relaton.org/model/bibtype/[Relaton model -- Bibitem type].
The type is suppressed from rendering.
+
[example]
_standard_, _book_, _inbook_

If spans are used, an inline image included in the reference is interpreted as
the depiction of the resource
 [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.9.8]
+
.An inline image in the reference as the depiction of the resource
[example]
====
[source,adoc]
----
span:title[Standard 123] image:thumbnail.jpg[]
----
====


NOTE: The surname must always precede the initials or given name for a given author in spans,
to prevent ambiguity and confusion in parsing the reference.
The rendered ordering of initials/given name and surname for the first
and for subsequent names is determined by the flavour reference stylesheet.
So `span:surname[Fields], span:initials:[W.C.]`,
never `span:initials:[W.C.] span:surname[Fields]`.

NOTE: After the first instances of `surname` and either `initials` or
`givenname`, any subsequent instances of `surname` or either `initials` or
`givenname` are interpreted as belonging to a new contributor of the same role.

NOTE: `span:fullname[]` is intended as a convenience method to substitute
`span:surname[]`, `span:initials[]`, `span:givenname[]` in a single macro. It
has a strict syntax, and any special cases need to be marked up with the
separate, explicit name parts instead:

* The surname is a single word (space-delimited), occurring at the end.
See the examples below.
+
`span:fullname[A. D. Navarro Cortez]`::: surname is _Cortez_.
`span:initials[A. D.] span:surname[Navarro Cortez]`::: surname is _Navarro Cortez_.
`span:fullname[A. D. Navarro-Cortez]`::: surname is _Navarro-Cortez_.

* Anything before the surname is a given name. So in
`span:fullnamename[J. Edgar Hoover]`, both _J._ and _Edgar_ are processed as given names.

* If everything before the surname ends in a full stop, they are all deemed
initials. So in `span:fullname[A. D. Navarro Cortez]`, _A. D._ are parsed as initials.

[example]
.Example encoding of a bibliographic item inline with semantic markup
====
[source,asciidoc]
----
* [[[A, B]]],
  span:surname[Wozniak], span:initials[S.], span:surname[Jobs], span:givenname[Steve],
    & surname:[Hoover], span:initials[J.] span:givenname[Edgar].
  span:date.issued[1991].
  span:date[1996].
  span:title[_Work_].
  In span:in_surname.editor[Gates], span:in_initials.editor[W. H] &
  span:in_organization[UNICEF],
  span:in_title[Collected Essays].
  span:series[Bibliographers Anonymous].
  span:docid.ISO[ISO 1234].
  span:pubplace[Geneva]:
  span:publisher[International Standardization Organization].
  span:uri.citation[http://www.example.com].
  vol. span:volume[5],
  pp. span:pages[2-21]
  span:type[inbook]
----
====

Note the distinction in the example between Wozniak and Jobs (authors of the paper),
and Gates and UNICEF (editors of the book including the paper). Similarly, note the
distinction between the title of the paper (_Work_), and the title of the book including
the paper (_Collected Essays_).

After the first instances of `surname` and either `initials` or `givenname`, any
subsequent instance of `surname` is
interpreted as belonging to a new contributor of the same role.

Any given names and surnames MUST follow the surname that they relate to. If the names
are ordered differently between the first and subsequent name, e.g. _Wozniak, S. & Steve Jobs_,
that will be taken care of in rendering: they cannot be annotated in that way.

[NOTE]
--
For presentations,

* `title` is the title of the presentation
* `series` is the title of the conference
* `organization.distributor` is the organizer of the conference
--

[IMPORTANT]
--
The rendering of different bibliographic types is quite different in the various
stylesheets that SDOs follow, and strange things will happen if Metanorma gets
the bibliographic type wrong.

Under Metanorma, the default bibliographic type is `standard`, and most SDOs
render standards in bibliographies with very little data (no author, no
publisher, no date outside of the document identifier, and so on).

If you use this notation to enter any document other than a standard, you *must*
specify the type of document, using `span:type[]`.
--

=== Last access date auto-retrieval and override

Metanorma supports auto-retrieval of URLs in order to set the "last accessed"
date for a bibliographic item with URL.

This is performed through the `relaton-render` gem, where the URLs in the
reference will be tried for access, and Metanorma styles the result to align to
the flavour's bibliographical stylesheet.

[example]
Append `span:date.accessed[2020-01-01]` at the end of the reference.

If your flavour requires date last accessed to be supplied for references with
URLs, you should use `date.accessed[...]` to do so.

If you do not do so, Metanorma will try to access the URLs in the reference
automatically.

If the URI is not accessible, no date last accessed will be given.

Typically, SDO expectation is that authors should provide dates last accessed
for references they have reviewed themselves.


[[emebd-citation]]
=== Overriding auto-fetched reference fields

The bibliographic `span:...[]` notation can be used to emend bibliographic
entries fetched through
Relaton [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.3.4].
This is only done if the document identifier is wrapped with
`amend(...)` [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v3.1.3].
If the identifier is not wrapped with `amend(...)`, the supplied bibliographic `span:...[]` notation
is used instead of the fetched bibliographic record.

NOTE: This is particularly important for DOI auto-fetched information, as the
Crossref records are of variable quality, and often lack crucial information for
citations.

* Data encoded in the title following the bibliographic anchor with `span:[]` is
used to supplement auto-fetched information.

* If the `span` information presents information absent in the fetched record,
it is added to the record.

* If the `span` information presents information corresponding in the fetched
record, it overwrites it.

* Information is broken down by type:

** If an identifier, or URI, or date is of a given type, it overwrites only
identifiers of the same type in the fetched record
(e.g. `span:docid.BSI[BSI EN 8000]`, `span:date.published[2010]`).

** The same applies to contributors: contributors of a given type overwrite only
contributors of the same type in the fetched record.

** For document identifiers, you will need the type of the SDO issuing the
document, which is typically the standard organization abbreviation. Look at the
Semantic XML of the document for the currently fetched document, to make sure.

* Information is replaced, not additive.
+
[example]
If there are multiple authors in the fetched record, they are replaced by the
listing of multiple authors in the bibliographic spans.

To illustrate, the following citation modifies the record fetched from Crossref.

.Metanorma bibliographic entry with DOI identifier fetch and data override
[source,asciidoc]
----
* [[[ref1,amend(doi:10.1045/november2010-massart)]]],
  span:surname.author[Johnson], span:givenname.author[Boris],
  span:pages[8-10],
  span:date.published[2021]
----

The modifications are:

* The pages span are added to the source record, which contains volume and issue
information, but no page information.

* The authors listed for the source record are overwritten by the single author
"Boris Johnson".

* The date published is overwritten by the new date 2021. The date the article
was issued, by contrast, is left alone.

[[bibtex]]
=== Importing bibliographic records from other formats
Metanorma can import files containing bibliographic records in other
formats [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.2.9].
To date, only Bibtex is supported.

In order to specify an external Bibtex file, use the `relaton-data-source` document
attribute:

[source,asciidoc]
----
:relaton-data-source: path/to/bibtex-file
----

In order to specify multiple external Bibtex files, use `relaton-data-source-{id}`
document attributes, where the value of `{id}` is the source identifier
used to differentiate each import file:

[source,asciidoc]
----
:relaton-data-source-bib1: path/to/first/bibtex-file
:relaton-data-source-bib2: path/to/second/bibtex-file
----

References to a bibliographic item imported this way are expressed in the bibliography
with the bibliographic anchor `local-file(SOURCE, KEY)`, where `SOURCE` is the name
of the source identifier for the import file, and `KEY` is the identifier of the
reference in the import file. So given the import statements above,

[source,asciidoc]
----
== Bibliography
* [[[ref1, local-file(bib1, tc211)]]]
----

will import the reference inside the Bibtex file `path/to/first/bibtex-file`
(the value of `relaton-data-source-bib1`) that starts as e.g.

[source]
----
@book{tc211
  ...
}
----

If only one file was imported through `relaton-data-source`, the source identifier
is omitted (or else "default" is used):

[source,asciidoc]
----
== Bibliography
* [[[ref1, local-file(tc211)]]]
----

[[asciibib]]
=== Entering with AsciiBib

Bibliographic entries can be entered in the AsciiBib format.

AsciiBib is a bibliography entry format that uses AsciiDoc definition lists to
capture the structure of Relaton XML.

This approach is documented in
https://www.relaton.org/asciibib/[relaton.org].

[example]
.Example of entering an entry using AsciiBib (ISO 123) with an AsciiBib ID
====
[source,asciidoc]
--
[bibliography]
== Normative references

[%bibitem]
=== Rubber latex -- Sampling
id:: iso123
docid::
type::: ISO
id::: ISO 123
docid::
type::: ABC
id::: 32784
type:: standard
--
====

The `id` attribute of `%bibitem` clauses (the anchor of the clause) can be
overridden by a Metanorma AsciiDoc anchor on the
clause [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v1.6.1].

This can be required for Metanorma AsciiDoc to process cross-references correctly.

NOTE: Metanorma AsciiDoc anchors must not be preceded by `_`, as Metanorma
AsciiDoc uses that to indicate anchors it inserts automatically, which are not
supplied in the source.

[example]
.Example of entering an entry using AsciiBib (ISO 123) with an AsciiDoc anchor
====
[source,asciidoc]
--
[bibliography]
== Normative references

[[iso123]]
[%bibitem]
=== Rubber latex -- Sampling
id:: iso123
docid::
type::: ISO
id::: ISO 123
docid::
type::: ABC
id::: 32784
type:: standard
--
====

=== Suppressing display

It is expected that if a citation is made in the main body of the document, its
corresponding reference will be included in the bibliography. It is however
possible to suppress display of that reference in the bibliography, by wrapping
it in
`hidden()` [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v1.11.4].

[source,asciidoc]
--
[bibliography]
== Bibliography

* [[[ref1,hidden(ISO 639-1)]]], ISO 639-1.
* [[[ref2,ISO 639-2]]], ISO 639-2.
--

=== Entering with Relaton XML (EXPERT only)

WARNING: This functionality is strongly discouraged due to the ease of breaking
the resulting Metanorma XML. It is useful only for limited use cases and
only intended for experts.

Bibliographic entries can also be given as raw https://www.relaton.org[Relaton XML],
in an AsciiDoc passthrough block.

Of course, any Relaton XML BibItem entries need to be valid, and using correct
`id` attributes.

[example]
.Example of entering an entry using Relaton XML (ISO 1)
====
[source,asciidoc]
--
[bibliography]
== Normative references

++++
<bibitem id="doc1">
<docidentifier>ISO 1</docidentifier>
<title>Geometrical product specifications (GPS) -- Standard reference temperature for the specification of geometrical and dimensional properties</title>
</bibitem>
++++
--
====


== Reference processing flags

=== General

Various processing flags can be entered at the document identifier element to
specify different reference processing behaviour. All such flags are optional.

Reference processing flags need to be entered according to the following patterns:

[source,adoc]
----
[[[{anchor},nofetch(hidden(dropid({document identifier or reference tag})))]]]
----

`nofetch()`:: Disable automatic lookup of references. See <<disable-auto-fetch>>

`hidden()`:: Do not show this item in the bibliography. See <<hidden-citations>>.

`dropid()`:: Do not display the document identifier. See <<dropid>>.


NOTE: The `repo:()` and `path:()` functions are to be entered as document
identifiers in this pattern.

[[disable-auto-fetch]]
=== Disable auto-fetch with `nofetch()`

See link:/author/basics/reference-lookups/#nofetch[Automatic reference lookup: Disabling automatic lookup].


[[dropid]]
=== Ignoring document identifiers with `dropid()`

The document identifier is critical to formulating both citations and
bibliographies. There are times, however, where the supplied document identifier
is to be ignored in bibliographies.

When a manual bibliographic item is entered (not auto-fetched),
with a user-defined anchor and the document identifier in triple brackets,
followed by bibliographic details provided as text.

In this case, the bibliographic item is rendered with the document identifier
placed in brackets after the provided bibliographic details, as it is shown in
<<dropid-example-1>>.

[[dropid-example-1]]
[example]
.Example of a manually-entered bibliographic item with document identifier shown after bibliographic details
====
[source,asciidoc]
----
* [[[id1,ELOT 743]]], _Transliteration of Greek into Roman script._
----

Notice that the document identifier is placed in brackets after the provided
bibliographic details:

____
[1] _Transliteration of Greek into Roman script._ [ELOT 743]
____
====

There are situations where it is useful to suppress the document identifier in
the bibliography, for example:

* the bibliographic item is not a standard, so the identifier should not be
used;

* there is no authoritative form for the document identifier for this
bibliographic item.

The `dropid()` [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.1.4]
citation processing flag can be used to suppress the appearance of the document
identifier in the bibliography.

[example]
.Example of using `dropid(...)` to drop rendering of a document identifier in the bibliography
====
[source,asciidoc]
----
* [[[id1,dropid(GIBBON)]]], Gibbon, Edward. 1776-1789. _Decline and fall of the Roman Empire._ London: Strahan & Cadell.
----

The resulting rendering omits the document identifier:

____
[1] Gibbon, Edward. 1776-1789. _Decline and fall of the Roman Empire._ London: Strahan & Cadell.
____
====

As noted above, leaving the refeence tag as a space has the same effect: `*[[[id, ]]], Gibbon...`.


[[hidden-citations]]
=== Hiding citations with `hidden()`

It is possible to add a citation to a document while suppressing its rendering
in all rendered outputs.

This is done so that the Metanorma Semantic XML will still contain information
about the citation, and can use it, for instance, to populate cross-references
to that document.

A hidden citation can be added to a Metanorma document by wrapping the reference
tag in `hidden(...)`. [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.0.0]

[example]
.Example of hiding a named reference (ISO 8601-1:2019)
====
The following encoding will hide the particular bibliographic reference.

[source,asciidoc]
--
[bibliography]
== Normative references

* [[[iso86011,hidden(ISO 8601-1:2019)]]]
--
====

=== CSV notation

The notation shown up to this point for reference processing flags has the
potential of being too complicated to parse, if deeply nested or if the
parentheses of flags are combined with the parentheses of user-supplied labels
or of "all parts".

For that reason, an alternative notation is supported, involving key/value pairs
delimited by comma and equals signs in the anchor label [added in https://github.com/metanorma/metanorma-standoc/releases/tag/v2.4.4].

For example, the following two references are equivalent:

[source,asciidoc]
----
[bibliography]
== Normative references

* [[[iso8601_1,nofetch((Date-Time)ISO 8601-1:2019)]]], _Date and time — Representations for information interchange — Part 1: Basic rules_
* [[[iso8601_1a,nofetch=true,usrlabel=Date-Time,code=ISO 8601-1:2019]]], _Date and time — Representations for information interchange — Part 1: Basic rules_
----

The CSV-based notation has the following keys:

`nofetch`:: `true`|`false`
`hidden`:: `true`|`false`
`dropid`:: `true`|`false`
`local-file`:: (filename of local Relaton cache)
`repo`:: (repository name)/(document entry)
`path`:: (file path)
`number`:: (number, for a numeric ID of a citation)
`usrlabel`:: (user-supplied label of reference)
`code`:: (authoritative identifier of reference)

If no key is supplied in the CSV entry, it is assumed to be a code; e.g. `nofetch=true,usrlabel=Date-Time,ISO 8601-1:2019`
is interpreted as `nofetch=true,usrlabel=Date-Time,code=ISO 8601-1:2019`.
